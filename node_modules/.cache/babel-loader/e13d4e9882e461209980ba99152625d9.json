{"ast":null,"code":"import _objectSpread from\"/Users/admin/Desktop/SourceDevVieON/LiveEvent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/admin/Desktop/SourceDevVieON/LiveEvent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/admin/Desktop/SourceDevVieON/LiveEvent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/admin/Desktop/SourceDevVieON/LiveEvent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/admin/Desktop/SourceDevVieON/LiveEvent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{CButton,CModal,CModalBody,CModalHeader}from\"@coreui/react\";import CIcon from\"@coreui/icons-react\";import{useDispatch,useSelector}from\"react-redux\";import{getContentProviderById}from\"../../../actions/content\";import AdsContentItem from\"../ContentList/ItemContentList/AdsContentItem\";import NameContentProviderItem from\"../ContentList/ItemContentList/NameContentProviderItem\";import StatusContentItem from\"../ContentList/ItemContentList/StatusContentItem\";import contentApi from\"../../../apis/contentApi\";import{parsedIdAdsGroups,parsedIdContentProvider,parsedPageLimit}from\"../../../helpers/common\";import{closePopup}from\"../../../actions/popup\";import inStreamAdsApi from\"../../../apis/inStreamAdsApi\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PopupEditContentList=function PopupEditContentList(props){var _dataContent$CONTENT_;var currentItemAds=props.currentItemAds,currentItem=props.currentItem,currentItemContentProvider=props.currentItemContentProvider,currentPage=props.currentPage,rowPerPage=props.rowPerPage,setCurrentPageList=props.setCurrentPageList,keyWord=props.keyWord,category=props.category,type=props.type,idContentProvider=props.idContentProvider,idAdsGroup=props.idAdsGroup;var _ref=currentItemAds||{},status=_ref.status,group=_ref.group;var idProvider=currentItemContentProvider===null||currentItemContentProvider===void 0?void 0:currentItemContentProvider.id;var _ref2=currentItem||{},contentProviders=_ref2.contentProviders;var arrIdContentProvider=parsedIdContentProvider(contentProviders);var arrIdInStreamAds=parsedIdAdsGroups(contentProviders);var dispatch=useDispatch();var dataContent=useSelector(function(state){return state===null||state===void 0?void 0:state.Content;});var nameItemProvider=dataContent===null||dataContent===void 0?void 0:(_dataContent$CONTENT_=dataContent.CONTENT_PROVIDER)===null||_dataContent$CONTENT_===void 0?void 0:_dataContent$CONTENT_.name;var itemContentProvider=dataContent===null||dataContent===void 0?void 0:dataContent.CONTENT_PROVIDER;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),currentPageProvider=_useState2[0],setPageProvider=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),dataContentList=_useState4[0],setDataProvider=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),metadataProvider=_useState6[0],setMetadataProvider=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),listAdsGroups=_useState8[0],setListAdsGroups=_useState8[1];var getListAdsGroups=function getListAdsGroups(id){inStreamAdsApi.getListAllInStreamAds(id).then(function(res){var data=res===null||res===void 0?void 0:res.data;if(res===null||res===void 0?void 0:res.success){setListAdsGroups(data===null||data===void 0?void 0:data.items);}});};useEffect(function(){function getList(){return _getList.apply(this,arguments);}function _getList(){_getList=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:contentApi.getListContentProvider(10,currentPageProvider).then(function(res){var data=res===null||res===void 0?void 0:res.data;if(res===null||res===void 0?void 0:res.success){setMetadataProvider(data===null||data===void 0?void 0:data.metadata);var dataList=_toConsumableArray(dataContentList);var newDataList=dataList.concat(data===null||data===void 0?void 0:data.items);setDataProvider(newDataList);}});case 1:case\"end\":return _context.stop();}}},_callee);}));return _getList.apply(this,arguments);}getList();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[currentPageProvider]);useEffect(function(){function watchScroll(){window.addEventListener(\"scroll\",handleScroll);}watchScroll();return function(){window.removeEventListener(\"scroll\",handleScroll);};});var handleScroll=function handleScroll(){var _ref3=metadataProvider||{},page=_ref3.page,limit=_ref3.limit,total=_ref3.total;var maxPage=parsedPageLimit(total,limit);if((page+1)*limit>=total&&page+1>maxPage)return;setPageProvider((page||0)+1);};useEffect(function(){setStatus(status);setGroupAds(group);setNameProvider(nameItemProvider);},[status,group,nameItemProvider]);useEffect(function(){if(idProvider)dispatch(getContentProviderById(idProvider));// eslint-disable-next-line react-hooks/exhaustive-deps\n},[currentItemContentProvider]);var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),idContentProviders=_useState10[0],setIdContentProvider=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),idInStreamAds=_useState12[0],setIdInStreamAds=_useState12[1];var _useState13=useState({id:'',status:null}),_useState14=_slicedToArray(_useState13,2),elementAds=_useState14[0],setElementAds=_useState14[1];useEffect(function(){if(elementAds===null||elementAds===void 0?void 0:elementAds.id)handleChangeIdAdsGroups(elementAds);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[elementAds===null||elementAds===void 0?void 0:elementAds.id,elementAds===null||elementAds===void 0?void 0:elementAds.status]);var onChangeContentProvider=function onChangeContentProvider(item){var arr=_toConsumableArray(arrIdContentProvider);arr=arr.filter(function(ite){return ite!==(itemContentProvider===null||itemContentProvider===void 0?void 0:itemContentProvider.id);});arr.push(item===null||item===void 0?void 0:item.id);setIdContentProvider(arr);};var handleChangeIdAdsGroups=function handleChangeIdAdsGroups(elm){var _idAds$;var idAds=_toConsumableArray(arrIdInStreamAds);idAds=idAds.filter(function(ite){return(ite===null||ite===void 0?void 0:ite.id)!==(currentItemAds===null||currentItemAds===void 0?void 0:currentItemAds.id);});idAds.push(elm);if(((_idAds$=idAds[0])===null||_idAds$===void 0?void 0:_idAds$.id)===undefined){idAds.splice(0,1);setIdInStreamAds(idAds);}else{setIdInStreamAds(idAds);}};var onChangeAdsItem=function onChangeAdsItem(item){setElementAds(_objectSpread(_objectSpread({},elementAds),{},{id:item===null||item===void 0?void 0:item.id,status:item===null||item===void 0?void 0:item.status}));handleChangeIdAdsGroups(elementAds);};var onChangeStatus=function onChangeStatus(item){setElementAds(_objectSpread(_objectSpread({},elementAds),{},{status:item===null||item===void 0?void 0:item.status}));handleChangeIdAdsGroups(elementAds);};var _useState15=useState(status||''),_useState16=_slicedToArray(_useState15,2),currentStatus=_useState16[0],setStatus=_useState16[1];var _useState17=useState(group||''),_useState18=_slicedToArray(_useState17,2),currentGroup=_useState18[0],setGroupAds=_useState18[1];var _useState19=useState(nameItemProvider||''),_useState20=_slicedToArray(_useState19,2),currentNameProvider=_useState20[0],setNameProvider=_useState20[1];var handleClose=function handleClose(){dispatch(closePopup());};var handleSave=function handleSave(){var idContent=currentItem===null||currentItem===void 0?void 0:currentItem.id;contentApi===null||contentApi===void 0?void 0:contentApi.editContent(idContent,idContentProviders,idInStreamAds).then(function(res){if(res===null||res===void 0?void 0:res.success){contentApi===null||contentApi===void 0?void 0:contentApi.getContentList(currentPage-1,rowPerPage,keyWord,category,type,idContentProvider,idAdsGroup).then(function(resList){var data=resList===null||resList===void 0?void 0:resList.data;if(resList===null||resList===void 0?void 0:resList.success){setCurrentPageList(data===null||data===void 0?void 0:data.items);dispatch(closePopup());}});}});};return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(CModal// size={'lg'}\n,{show:true,onClose:handleClose,centered:true,closeOnBackdrop:false,style:{minWidth:'555px'},children:[/*#__PURE__*/_jsx(CModalHeader,{style:{backgroundColor:'#646464'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-100 d-flex justify-content-between align-items-center\",style:{color:\"#FFF\"},children:[/*#__PURE__*/_jsx(\"h4\",{className:\"mb-0\",children:\"S\\u1EEDa Content\"}),/*#__PURE__*/_jsx(CButton,{className:\"p-0 shadow-none\",onClick:handleClose,children:/*#__PURE__*/_jsx(CIcon,{name:\"cil-x\",style:{color:\"#FFF\"}})})]})}),/*#__PURE__*/_jsxs(CModalBody,{children:[/*#__PURE__*/_jsxs(\"div\",{className:'d-flex flex-row',children:[/*#__PURE__*/_jsx(NameContentProviderItem,{dataContentList:dataContentList,nameItemProvider:currentNameProvider,setNameProvider:setNameProvider,onChangeContentProvider:onChangeContentProvider,arrIdContentProvider:arrIdContentProvider,getListAdsGroups:getListAdsGroups,handleScroll:handleScroll}),/*#__PURE__*/_jsx(AdsContentItem,{listAdsGroup:listAdsGroups,groupName:currentGroup,setGroupAds:setGroupAds,onChangeAdsItem:onChangeAdsItem}),/*#__PURE__*/_jsx(StatusContentItem,{onChangeStatus:onChangeStatus,status:currentStatus,setStatus:setStatus})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-end mt-3\",children:/*#__PURE__*/_jsx(CButton,{className:\"pl-4 pr-4\",color:\"success\",onClick:handleSave,children:\"L\\u01B0u\"})})]})]})});};export default PopupEditContentList;","map":{"version":3,"sources":["/Users/admin/Desktop/SourceDevVieON/LiveEvent/src/views/instream-ads/Popup/PopupEditContentList.js"],"names":["React","useEffect","useState","CButton","CModal","CModalBody","CModalHeader","CIcon","useDispatch","useSelector","getContentProviderById","AdsContentItem","NameContentProviderItem","StatusContentItem","contentApi","parsedIdAdsGroups","parsedIdContentProvider","parsedPageLimit","closePopup","inStreamAdsApi","PopupEditContentList","props","currentItemAds","currentItem","currentItemContentProvider","currentPage","rowPerPage","setCurrentPageList","keyWord","category","type","idContentProvider","idAdsGroup","status","group","idProvider","id","contentProviders","arrIdContentProvider","arrIdInStreamAds","dispatch","dataContent","state","Content","nameItemProvider","CONTENT_PROVIDER","name","itemContentProvider","currentPageProvider","setPageProvider","dataContentList","setDataProvider","metadataProvider","setMetadataProvider","listAdsGroups","setListAdsGroups","getListAdsGroups","getListAllInStreamAds","then","res","data","success","items","getList","getListContentProvider","metadata","dataList","newDataList","concat","watchScroll","window","addEventListener","handleScroll","removeEventListener","page","limit","total","maxPage","setStatus","setGroupAds","setNameProvider","idContentProviders","setIdContentProvider","idInStreamAds","setIdInStreamAds","elementAds","setElementAds","handleChangeIdAdsGroups","onChangeContentProvider","item","arr","filter","ite","push","elm","idAds","undefined","splice","onChangeAdsItem","onChangeStatus","currentStatus","currentGroup","currentNameProvider","handleClose","handleSave","idContent","editContent","getContentList","resList","minWidth","backgroundColor","color"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react'\nimport {\n  CButton,\n  CModal,\n  CModalBody,\n  CModalHeader,\n} from \"@coreui/react\";\nimport CIcon from \"@coreui/icons-react\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {getContentProviderById} from \"../../../actions/content\";\nimport AdsContentItem from \"../ContentList/ItemContentList/AdsContentItem\";\nimport NameContentProviderItem from \"../ContentList/ItemContentList/NameContentProviderItem\";\nimport StatusContentItem from \"../ContentList/ItemContentList/StatusContentItem\";\nimport contentApi from \"../../../apis/contentApi\";\nimport {parsedIdAdsGroups, parsedIdContentProvider, parsedPageLimit} from \"../../../helpers/common\"\nimport {closePopup} from \"../../../actions/popup\";\nimport inStreamAdsApi from \"../../../apis/inStreamAdsApi\";\n\n\nconst PopupEditContentList = (props) => {\n  const {\n    currentItemAds,\n    currentItem,\n    currentItemContentProvider,\n    currentPage,\n    rowPerPage,\n    setCurrentPageList,\n    keyWord,\n    category,\n    type,\n    idContentProvider,\n    idAdsGroup,\n  } = props\n  const  { status, group} = currentItemAds || {}\n  const idProvider = currentItemContentProvider?.id\n  const {contentProviders} = currentItem || {}\n\n  const arrIdContentProvider = parsedIdContentProvider(contentProviders)\n  const arrIdInStreamAds = parsedIdAdsGroups(contentProviders)\n\n  const dispatch  = useDispatch()\n  const dataContent = useSelector(state => state?.Content)\n\n  const nameItemProvider =  dataContent?.CONTENT_PROVIDER?.name\n  const itemContentProvider = dataContent?.CONTENT_PROVIDER\n\n\n\n  const [currentPageProvider, setPageProvider] = useState(0)\n  const [dataContentList, setDataProvider] = useState([])\n  const [metadataProvider, setMetadataProvider] = useState()\n  const [listAdsGroups, setListAdsGroups] = useState([])\n\n  const getListAdsGroups = (id) => {\n    inStreamAdsApi.getListAllInStreamAds(id).then(res =>{\n      const data = res?.data\n      if (res?.success){\n        setListAdsGroups(data?.items)\n      }\n    })\n  }\n  useEffect( ()=>{\n    async function getList () {\n      contentApi.getListContentProvider(10, currentPageProvider).then(res=>{\n        const data = res?.data\n        if (res?.success) {\n          setMetadataProvider(data?.metadata)\n          let dataList = [...dataContentList]\n          let newDataList = dataList.concat(data?.items)\n          setDataProvider(newDataList)\n        }\n      })\n    }\n    getList()\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  },[currentPageProvider])\n\n\n  useEffect(() => {\n    function watchScroll() {\n      window.addEventListener(\"scroll\", handleScroll);\n    }\n    watchScroll()\n    return () => {\n      window.removeEventListener(\"scroll\", handleScroll);\n    }\n  })\n\n  const handleScroll = () => {\n    const { page, limit, total } = metadataProvider || {}\n    let maxPage = parsedPageLimit(total, limit)\n\n    if ((page + 1) * limit >= total && (page + 1) > maxPage) return\n    setPageProvider((page || 0) + 1 )\n  }\n  useEffect(()=>{\n    setStatus(status)\n    setGroupAds(group)\n    setNameProvider(nameItemProvider)\n\n  },[status, group, nameItemProvider ])\n\n\n  useEffect(()=> {\n    if (idProvider) dispatch(getContentProviderById(idProvider))\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  },[currentItemContentProvider])\n\n\n  const [idContentProviders, setIdContentProvider] = useState( [])\n  const [idInStreamAds, setIdInStreamAds] = useState([])\n\n  const [elementAds, setElementAds] = useState({\n    id: '',\n    status: null\n  })\n\n\n  useEffect(()=> {\n    if (elementAds?.id) handleChangeIdAdsGroups(elementAds)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  },[elementAds?.id, elementAds?.status])\n\n  const onChangeContentProvider = (item) => {\n    let arr = [...arrIdContentProvider]\n    arr = arr.filter(ite => ite !== itemContentProvider?.id)\n    arr.push(item?.id)\n    setIdContentProvider(arr)\n  }\n\n\n  const handleChangeIdAdsGroups = (elm) => {\n    let idAds = [...arrIdInStreamAds]\n    idAds = idAds.filter(ite => ite?.id !== currentItemAds?.id)\n    idAds.push(elm)\n    if (idAds[0]?.id === undefined){\n      idAds.splice(0,1)\n      setIdInStreamAds(idAds)\n    } else {\n      setIdInStreamAds(idAds)\n    }\n  }\n  const onChangeAdsItem = (item) => {\n    setElementAds({...elementAds, id: item?.id, status: item?.status})\n    handleChangeIdAdsGroups(elementAds)\n  }\n\n  const onChangeStatus = (item) => {\n    setElementAds({...elementAds, status: item?.status})\n    handleChangeIdAdsGroups(elementAds)\n  }\n\n\n  const [currentStatus, setStatus] = useState(status || '')\n  const [currentGroup, setGroupAds] = useState(group || '')\n  const [currentNameProvider, setNameProvider] = useState(nameItemProvider || '')\n\n  const handleClose =() => {\n    dispatch(closePopup())\n  }\n  const handleSave = () => {\n    const idContent = currentItem?.id\n    contentApi?.editContent(idContent, idContentProviders, idInStreamAds).then(res=>{\n      if (res?.success){\n        contentApi?.getContentList(\n          currentPage -1,\n          rowPerPage,\n          keyWord,\n          category,\n          type,\n          idContentProvider,\n          idAdsGroup\n        ).then(\n          resList =>{\n            const data = resList?.data\n            if (resList?.success) {\n              setCurrentPageList(data?.items)\n              dispatch(closePopup())\n            }\n          }\n        )\n      }\n    })\n  }\n\n\n  return (\n    <React.Fragment>\n      <CModal\n          // size={'lg'}\n        show={true}\n        onClose={handleClose}\n        centered={true}\n        closeOnBackdrop={false}\n        style={{minWidth: '555px'}}\n      >\n        <CModalHeader style={{ backgroundColor: '#646464' }}>\n          <div className=\"w-100 d-flex justify-content-between align-items-center\" style={{ color: \"#FFF\" }}>\n            <h4 className=\"mb-0\">Sửa Content</h4>\n            <CButton className='p-0 shadow-none' onClick={handleClose}>\n              <CIcon name=\"cil-x\" style={{ color: \"#FFF\" }}></CIcon>\n            </CButton>\n          </div>\n        </CModalHeader>\n        <CModalBody>\n          <div className={'d-flex flex-row'}>\n            <NameContentProviderItem\n              dataContentList={dataContentList}\n              nameItemProvider={currentNameProvider}\n              setNameProvider={setNameProvider}\n              onChangeContentProvider={onChangeContentProvider}\n              arrIdContentProvider={arrIdContentProvider}\n              getListAdsGroups={getListAdsGroups}\n              handleScroll={handleScroll}\n            />\n            <AdsContentItem\n              listAdsGroup={listAdsGroups}\n              groupName={currentGroup}\n              setGroupAds={setGroupAds}\n              onChangeAdsItem={onChangeAdsItem}\n            />\n            <StatusContentItem\n              onChangeStatus={onChangeStatus}\n              status={currentStatus} setStatus={setStatus}/>\n          </div>\n          <div className=\"d-flex justify-content-end mt-3\">\n            <CButton className=\"pl-4 pr-4\" color=\"success\" onClick={handleSave}>Lưu</CButton>\n          </div>\n        </CModalBody>\n      </CModal>\n    </React.Fragment>\n  )\n}\nexport default PopupEditContentList\n"]},"metadata":{},"sourceType":"module"}
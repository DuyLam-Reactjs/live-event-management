{"ast":null,"code":"import _regeneratorRuntime from\"/Users/admin/Desktop/SourceDevVieON/LiveEvent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/admin/Desktop/SourceDevVieON/LiveEvent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/admin/Desktop/SourceDevVieON/LiveEvent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/admin/Desktop/SourceDevVieON/LiveEvent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import TablesContentList from\"../../base/tables/TablesContentList\";import{CInput,CInputGroup}from\"@coreui/react\";import CIcon from\"@coreui/icons-react\";import TypeContent from\"./TypeContent\";import CategotyContent from\"./CategoryContent\";import ListNameContentProvider from\"./ListNameContentProvider\";import AdsGroupContent from\"./AdsGroupContent\";import{freeSet}from\"@coreui/icons\";import{useDispatch,useSelector}from\"react-redux\";import contentApi from\"../../../apis/contentApi\";import{getListAllInStreamAds}from\"../../../actions/inStreamAds\";import TitleAds from\"../TitleAds/TitleAds\";import{parsedPageLimit}from\"../../../helpers/common\";import{useHistory,useLocation}from\"react-router\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var queryString=require('query-string');var ContentList=function ContentList(){var _dataListAds$LIST_ALL;var dataListAds=useSelector(function(state){return state.InStreamAds;});var history=useHistory();var dispatch=useDispatch();var location=useLocation();var parsedID=queryString.parse(location.search);var idProvider=parsedID===null||parsedID===void 0?void 0:parsedID.id;var listAdsGroups=dataListAds===null||dataListAds===void 0?void 0:(_dataListAds$LIST_ALL=dataListAds.LIST_ALL_INSTREAM_ADS)===null||_dataListAds$LIST_ALL===void 0?void 0:_dataListAds$LIST_ALL.items;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),currentPageList=_useState2[0],setCurrentPageList=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),total=_useState4[0],setTotal=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),currentPage=_useState6[0],setCurrentPage=_useState6[1];var _useState7=useState(10),_useState8=_slicedToArray(_useState7,2),rowPerPage=_useState8[0],setRowPerPage=_useState8[1];var _useState9=useState(1),_useState10=_slicedToArray(_useState9,2),maxPage=_useState10[0],setMaxPage=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),keyWord=_useState12[0],setKeyWord=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),category=_useState14[0],setCategory=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),type=_useState16[0],setType=_useState16[1];var _useState17=useState(idProvider||''),_useState18=_slicedToArray(_useState17,2),idContentProvider=_useState18[0],setIdContentProvider=_useState18[1];var _useState19=useState(''),_useState20=_slicedToArray(_useState19,2),idAdsGroup=_useState20[0],setIdAdsGroup=_useState20[1];var _useState21=useState(0),_useState22=_slicedToArray(_useState21,2),currentPageProvider=_useState22[0],setPageProvider=_useState22[1];var _useState23=useState([]),_useState24=_slicedToArray(_useState23,2),dataContentList=_useState24[0],setDataProvider=_useState24[1];var _useState25=useState(),_useState26=_slicedToArray(_useState25,2),metadataProvider=_useState26[0],setMetadataProvider=_useState26[1];useEffect(function(){function getList(){return _getList.apply(this,arguments);}function _getList(){_getList=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:contentApi.getListContentProvider(10,currentPageProvider).then(function(res){var data=res===null||res===void 0?void 0:res.data;if(res===null||res===void 0?void 0:res.success){setMetadataProvider(data===null||data===void 0?void 0:data.metadata);var dataList=_toConsumableArray(dataContentList);var newDataList=dataList.concat(data===null||data===void 0?void 0:data.items);setDataProvider(newDataList);}});case 1:case\"end\":return _context.stop();}}},_callee);}));return _getList.apply(this,arguments);}getList();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[currentPageProvider]);useEffect(function(){function watchScroll(){window.addEventListener(\"scroll\",handleScroll);}watchScroll();return function(){window.removeEventListener(\"scroll\",handleScroll);};});var handleScroll=function handleScroll(){var _ref=metadataProvider||{},page=_ref.page,limit=_ref.limit,total=_ref.total;var maxPage=parsedPageLimit(total,limit);if((page+1)*limit>=total&&page+1>maxPage)return;setPageProvider((page||0)+1);};var _useState27=useState(),_useState28=_slicedToArray(_useState27,2),dataType=_useState28[0],setDataType=_useState28[1];useEffect(function(){contentApi===null||contentApi===void 0?void 0:contentApi.getContentType().then(function(res){var data=res===null||res===void 0?void 0:res.data;if(res.success){setDataType(data===null||data===void 0?void 0:data.items);}});},[]);var _useState29=useState(),_useState30=_slicedToArray(_useState29,2),dataCategories=_useState30[0],setDataCategories=_useState30[1];useEffect(function(){contentApi===null||contentApi===void 0?void 0:contentApi.getContentCategories().then(function(res){var data=res===null||res===void 0?void 0:res.data;if(res.success){setDataCategories(data===null||data===void 0?void 0:data.items);}});},[]);useEffect(function(){if(currentPageList){var max=parsedPageLimit(total,rowPerPage);setMaxPage(max);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[total,rowPerPage]);var handleChangeType=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(item){var type;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:type=item===null||item===void 0?void 0:item.id;_context2.next=3;return setType(type);case 3:setCurrentPage(1);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function handleChangeType(_x){return _ref2.apply(this,arguments);};}();var handleChangeCategory=function handleChangeCategory(item){var category=item===null||item===void 0?void 0:item.id;setCategory(category);setCurrentPage(1);};var handleChangeListName=function handleChangeListName(item){if((item===null||item===void 0?void 0:item.id)==='all'){history.push('/instream-ads/content-list');setIdContentProvider('');}else{var idContentProviderItem=item===null||item===void 0?void 0:item.id;setIdContentProvider(idContentProviderItem);setCurrentPage(1);if(idContentProviderItem){getListAdsGroups(idContentProviderItem);}}};var getListAdsGroups=function getListAdsGroups(id){dispatch(getListAllInStreamAds(id));};var handleChangeAdsGroups=function handleChangeAdsGroups(item){if((item===null||item===void 0?void 0:item.id)==='all'){history.push('/instream-ads/content-list');setIdAdsGroup('');}else{var idAdsGroupsItem=item===null||item===void 0?void 0:item.id;setIdAdsGroup(idAdsGroupsItem);setCurrentPage(1);}};var handleChangeKeyword=function handleChangeKeyword(e){var _e$target$value;var value=(_e$target$value=e.target.value)===null||_e$target$value===void 0?void 0:_e$target$value.toLowerCase();setKeyWord(value);};var handleKeyPress=function handleKeyPress(event){if(event.key==='Enter'){searchAndFilter();}};var searchAndFilter=function searchAndFilter(){contentApi.getContentList(currentPage-1,rowPerPage,keyWord,category,type,idContentProvider,idAdsGroup).then(function(res){if(res.success){var _data$metadata;var data=res===null||res===void 0?void 0:res.data;setCurrentPageList(data===null||data===void 0?void 0:data.items);setTotal(data===null||data===void 0?void 0:(_data$metadata=data.metadata)===null||_data$metadata===void 0?void 0:_data$metadata.total);}});};useEffect(function(){if(!category&&!type&&!idContentProvider&&!idAdsGroup){contentApi===null||contentApi===void 0?void 0:contentApi.getContentList(currentPage-1,rowPerPage,keyWord,category,type,idContentProvider,idAdsGroup).then(function(res){var data=res===null||res===void 0?void 0:res.data;if(res===null||res===void 0?void 0:res.success){var _data$metadata2;setCurrentPageList(function(){return data===null||data===void 0?void 0:data.items;});setTotal(data===null||data===void 0?void 0:(_data$metadata2=data.metadata)===null||_data$metadata2===void 0?void 0:_data$metadata2.total);}});}else searchAndFilter();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[currentPage,rowPerPage,category,type,idContentProvider,idAdsGroup]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(TitleAds,{title:\"Content List\"}),/*#__PURE__*/_jsxs(\"div\",{className:'d-flex flex-row',style:{marginBottom:'1rem',maxWidth:'100%'},children:[/*#__PURE__*/_jsx(TypeContent,{typeFilter:dataType,handleChangeType:handleChangeType}),/*#__PURE__*/_jsx(CategotyContent,{categoryFilter:dataCategories,handleChangeCategory:handleChangeCategory}),/*#__PURE__*/_jsx(ListNameContentProvider,{dataContentList:dataContentList,handleChangeListName:handleChangeListName,handleScroll:handleScroll,parsedID:parsedID}),/*#__PURE__*/_jsx(AdsGroupContent,{listAdsGroup:listAdsGroups,handleChangeAdsGroup:handleChangeAdsGroups}),/*#__PURE__*/_jsx(\"div\",{className:\"pr-2 pl-1\",children:/*#__PURE__*/_jsxs(CInputGroup,{className:\"pt-4\",style:{marginTop:'0.64rem'},children:[/*#__PURE__*/_jsx(CInput,{className:\"input-search\",name:\"keyword\",type:\"text\",placeholder:\"T\\xECm phim / show / k\\xEAnh\",style:{color:'#222'},onChange:handleChangeKeyword,onKeyPress:handleKeyPress}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-square btn-default color-black btn-search\",onClick:searchAndFilter,children:/*#__PURE__*/_jsx(CIcon,{content:freeSet.cilSearch,size:'lg',style:{margin:0}})})]})})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(TablesContentList,{currentPageList:currentPageList,setRowPerPage:setRowPerPage,setCurrentPage:setCurrentPage,rowPerPage:rowPerPage,currentPage:currentPage,maxPage:maxPage,setCurrentPageList:setCurrentPageList,keyWord:keyWord,category:category,type:type,idContentProvider:idContentProvider,idAdsGroup:idAdsGroup})})]});};export default ContentList;","map":{"version":3,"sources":["/Users/admin/Desktop/SourceDevVieON/LiveEvent/src/views/instream-ads/ContentList/ContentList.js"],"names":["React","useEffect","useState","TablesContentList","CInput","CInputGroup","CIcon","TypeContent","CategotyContent","ListNameContentProvider","AdsGroupContent","freeSet","useDispatch","useSelector","contentApi","getListAllInStreamAds","TitleAds","parsedPageLimit","useHistory","useLocation","queryString","require","ContentList","dataListAds","state","InStreamAds","history","dispatch","location","parsedID","parse","search","idProvider","id","listAdsGroups","LIST_ALL_INSTREAM_ADS","items","currentPageList","setCurrentPageList","total","setTotal","currentPage","setCurrentPage","rowPerPage","setRowPerPage","maxPage","setMaxPage","keyWord","setKeyWord","category","setCategory","type","setType","idContentProvider","setIdContentProvider","idAdsGroup","setIdAdsGroup","currentPageProvider","setPageProvider","dataContentList","setDataProvider","metadataProvider","setMetadataProvider","getList","getListContentProvider","then","res","data","success","metadata","dataList","newDataList","concat","watchScroll","window","addEventListener","handleScroll","removeEventListener","page","limit","dataType","setDataType","getContentType","dataCategories","setDataCategories","getContentCategories","max","handleChangeType","item","handleChangeCategory","handleChangeListName","push","idContentProviderItem","getListAdsGroups","handleChangeAdsGroups","idAdsGroupsItem","handleChangeKeyword","e","value","target","toLowerCase","handleKeyPress","event","key","searchAndFilter","getContentList","marginBottom","maxWidth","marginTop","color","cilSearch","margin"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react'\nimport TablesContentList from \"../../base/tables/TablesContentList\";\nimport {\n  CInput, CInputGroup,\n} from \"@coreui/react\";\nimport CIcon from \"@coreui/icons-react\";\nimport TypeContent from \"./TypeContent\";\nimport CategotyContent from \"./CategoryContent\";\nimport ListNameContentProvider from \"./ListNameContentProvider\";\nimport AdsGroupContent from \"./AdsGroupContent\";\nimport {freeSet} from \"@coreui/icons\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport contentApi from \"../../../apis/contentApi\";\nimport {getListAllInStreamAds} from \"../../../actions/inStreamAds\";\nimport TitleAds from \"../TitleAds/TitleAds\";\nimport {parsedPageLimit} from \"../../../helpers/common\";\nimport {useHistory, useLocation} from \"react-router\";\n\nconst queryString = require('query-string');\n\n\nconst ContentList = () => {\n\n  const dataListAds = useSelector(state => state.InStreamAds)\n\n  const history = useHistory()\n  const dispatch = useDispatch()\n  const location = useLocation()\n  const parsedID = queryString.parse(location.search)\n  const idProvider = parsedID?.id\n  const listAdsGroups = dataListAds?.LIST_ALL_INSTREAM_ADS?.items\n\n  const [currentPageList, setCurrentPageList] = useState([])\n  const [total, setTotal] = useState()\n  const [currentPage, setCurrentPage] = useState(1);\n  const [rowPerPage, setRowPerPage] = useState(10);\n  const [maxPage, setMaxPage] = useState(1);\n  const [keyWord, setKeyWord] = useState('')\n  const [category, setCategory] = useState('')\n  const [type, setType] = useState('')\n  const [idContentProvider, setIdContentProvider] = useState(idProvider || '')\n  const [idAdsGroup, setIdAdsGroup] = useState('')\n\n\n  const [currentPageProvider, setPageProvider] = useState(0)\n  const [dataContentList, setDataProvider] = useState([])\n  const [metadataProvider, setMetadataProvider] = useState()\n\n  useEffect( ()=>{\n    async function getList () {\n      contentApi.getListContentProvider(10, currentPageProvider).then(res=>{\n        const data = res?.data\n        if (res?.success) {\n          setMetadataProvider(data?.metadata)\n          let dataList = [...dataContentList]\n          let newDataList = dataList.concat(data?.items)\n          setDataProvider(newDataList)\n        }\n      })\n    }\n    getList()\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  },[currentPageProvider])\n\n\n  useEffect(() => {\n    function watchScroll() {\n      window.addEventListener(\"scroll\", handleScroll);\n    }\n    watchScroll()\n    return () => {\n      window.removeEventListener(\"scroll\", handleScroll);\n    }\n  })\n\n  const handleScroll = () => {\n    const { page, limit, total } = metadataProvider || {}\n    let maxPage = parsedPageLimit(total, limit)\n\n    if ((page + 1) * limit >= total && (page + 1) > maxPage) return\n    setPageProvider((page || 0) + 1 )\n  }\n\n\n  const [dataType, setDataType] = useState()\n  useEffect(()=>{\n    contentApi?.getContentType().then(res=>{\n      const data = res?.data\n      if (res.success) {\n        setDataType(data?.items)\n      }\n    })\n  },[])\n  const [dataCategories, setDataCategories] = useState()\n  useEffect(()=>{\n    contentApi?.getContentCategories().then(res=>{\n      const data = res?.data\n      if (res.success) {\n        setDataCategories(data?.items)\n      }\n    })\n  },[])\n\n  useEffect(() => {\n    if (currentPageList) {\n      let max = parsedPageLimit(total, rowPerPage)\n      setMaxPage(max)\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [total, rowPerPage])\n\n\n\n  const handleChangeType = async (item) => {\n    const type = item?.id\n    await setType( type)\n    setCurrentPage(1)\n  }\n  const handleChangeCategory = (item) =>{\n    const category = item?.id\n    setCategory( category)\n    setCurrentPage(1)\n  }\n  const handleChangeListName = (item) => {\n    if (item?.id === 'all'){\n      history.push('/instream-ads/content-list')\n      setIdContentProvider('')\n    }else {\n      const idContentProviderItem = item?.id\n      setIdContentProvider(idContentProviderItem)\n      setCurrentPage(1)\n      if (idContentProviderItem){\n        getListAdsGroups(idContentProviderItem)\n      }\n    }\n  }\n\n  const getListAdsGroups = (id) => {\n    dispatch(getListAllInStreamAds(id))\n  }\n\n  const handleChangeAdsGroups = (item) => {\n    if (item?.id === 'all'){\n      history.push('/instream-ads/content-list')\n      setIdAdsGroup('')\n    }else {\n      const idAdsGroupsItem = item?.id\n      setIdAdsGroup(idAdsGroupsItem)\n      setCurrentPage(1)\n    }\n  }\n  const handleChangeKeyword = (e) => {\n    const value = e.target.value?.toLowerCase()\n    setKeyWord(value)\n  }\n\n  const handleKeyPress = (event) => {\n    if (event.key === 'Enter') {\n      searchAndFilter();\n    }\n  }\n  const searchAndFilter = () => {\n    contentApi.getContentList(\n      currentPage-1,\n      rowPerPage,\n      keyWord,\n      category,\n      type,\n      idContentProvider,\n      idAdsGroup,\n    ).then(res=>{\n      if (res.success){\n        const data = res?.data\n        setCurrentPageList(data?.items)\n        setTotal(data?.metadata?.total)\n      }\n    })\n  }\n\n  useEffect(()=>{\n\n    if (!category && !type && !idContentProvider && !idAdsGroup) {\n      contentApi?.getContentList(\n        currentPage -1,\n        rowPerPage,\n        keyWord,\n        category,\n        type,\n        idContentProvider,\n        idAdsGroup,\n      ).then(\n        res => {\n          const data = res?.data\n          if (res?.success) {\n            setCurrentPageList(() => data?.items)\n            setTotal(data?.metadata?.total)\n          }\n        }\n      )\n    }else searchAndFilter()\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [\n    currentPage,\n    rowPerPage,\n    category,\n    type,\n    idContentProvider,\n    idAdsGroup,\n  ])\n\n  return (\n    <div>\n      <TitleAds title={\"Content List\"}/>\n      <div className={'d-flex flex-row'} style={{marginBottom: '1rem', maxWidth: '100%'}}>\n        <TypeContent\n          typeFilter={dataType}\n          handleChangeType={handleChangeType}\n        />\n        <CategotyContent\n          categoryFilter={dataCategories}\n          handleChangeCategory={handleChangeCategory}\n        />\n        <ListNameContentProvider\n          dataContentList={dataContentList}\n          handleChangeListName={handleChangeListName}\n          handleScroll={handleScroll}\n          parsedID={parsedID}\n        />\n        <AdsGroupContent\n          listAdsGroup={listAdsGroups}\n          handleChangeAdsGroup={handleChangeAdsGroups}\n        />\n        <div className=\"pr-2 pl-1\">\n            <CInputGroup className=\"pt-4\" style={{marginTop: '0.64rem'}}>\n              <CInput\n                className=\"input-search\"\n                name='keyword'\n                type=\"text\"\n                placeholder='Tìm phim / show / kênh'\n                style={{ color: '#222'}}\n                onChange={handleChangeKeyword}\n                onKeyPress={handleKeyPress}\n              />\n              <button className=\"btn btn-square btn-default color-black btn-search\"\n                      onClick={searchAndFilter}>\n                <CIcon content={freeSet.cilSearch} size={'lg'} style={{margin: 0}} />\n              </button>\n            </CInputGroup>\n        </div>\n      </div>\n      <div>\n        <TablesContentList\n          currentPageList={currentPageList }\n          setRowPerPage={setRowPerPage}\n          setCurrentPage={setCurrentPage}\n          rowPerPage={rowPerPage}\n          currentPage={currentPage}\n          maxPage={maxPage}\n          setCurrentPageList={setCurrentPageList}\n          keyWord={keyWord}\n          category={category}\n          type={type}\n          idContentProvider={idContentProvider}\n          idAdsGroup={idAdsGroup}\n        />\n      </div>\n    </div>\n  )\n}\n\n\nexport default ContentList\n"]},"metadata":{},"sourceType":"module"}
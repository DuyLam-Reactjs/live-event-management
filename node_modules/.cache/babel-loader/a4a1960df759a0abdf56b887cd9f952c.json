{"ast":null,"code":"import _objectSpread from\"/Users/admin/Desktop/SourceDevVieON/LiveEvent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/admin/Desktop/SourceDevVieON/LiveEvent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/admin/Desktop/SourceDevVieON/LiveEvent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/admin/Desktop/SourceDevVieON/LiveEvent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/admin/Desktop/SourceDevVieON/LiveEvent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{CButton,CModal,CModalBody,CModalHeader}from\"@coreui/react\";import CIcon from\"@coreui/icons-react\";import StatusContentItem from\"../ContentList/ItemContentList/StatusContentItem\";import{parsedIdAdsGroups,parsedIdContentProvider,parsedPageLimit}from\"../../../helpers/common\";import contentApi from\"../../../apis/contentApi\";import GroupNameContentProvider from\"../ContentList/GroupNameContentProvider\";import GroupsAdsProvider from\"../ContentList/GroupsAdsProvider\";import{useDispatch}from\"react-redux\";import{closePopup}from\"../../../actions/popup\";import inStreamAdsApi from\"../../../apis/inStreamAdsApi\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PopupAddContentList=function PopupAddContentList(props){var _ref=props||{},currentItem=_ref.currentItem,currentPage=_ref.currentPage,rowPerPage=_ref.rowPerPage,setCurrentPageList=_ref.setCurrentPageList,keyWord=_ref.keyWord,category=_ref.category,type=_ref.type,idContentProvider=_ref.idContentProvider,idAdsGroup=_ref.idAdsGroup;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),currentPageProvider=_useState2[0],setPageProvider=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),dataContentList=_useState4[0],setDataProvider=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),metadataProvider=_useState6[0],setMetadataProvider=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),listAdsGroups=_useState8[0],setListAdsGroups=_useState8[1];var getListAdsGroups=function getListAdsGroups(id){inStreamAdsApi.getListAllInStreamAds(id).then(function(res){var data=res===null||res===void 0?void 0:res.data;if(res===null||res===void 0?void 0:res.success){setListAdsGroups(data===null||data===void 0?void 0:data.items);}});};useEffect(function(){function getList(){return _getList.apply(this,arguments);}function _getList(){_getList=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:contentApi.getListContentProvider(10,currentPageProvider).then(function(res){var data=res===null||res===void 0?void 0:res.data;if(res===null||res===void 0?void 0:res.success){setMetadataProvider(data===null||data===void 0?void 0:data.metadata);var dataList=_toConsumableArray(dataContentList);var newDataList=dataList.concat(data===null||data===void 0?void 0:data.items);setDataProvider(newDataList);}});case 1:case\"end\":return _context.stop();}}},_callee);}));return _getList.apply(this,arguments);}getList();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[currentPageProvider]);useEffect(function(){function watchScroll(){window.addEventListener(\"scroll\",handleScroll);}watchScroll();return function(){window.removeEventListener(\"scroll\",handleScroll);};});var handleScroll=function handleScroll(){var _ref2=metadataProvider||{},page=_ref2.page,limit=_ref2.limit,total=_ref2.total;var maxPage=parsedPageLimit(total,limit);if((page+1)*limit>=total&&page+1>maxPage)return;setPageProvider((page||0)+1);};var dispatch=useDispatch();var _ref3=currentItem||{},contentProviders=_ref3.contentProviders;var arrIdContentProvider=parsedIdContentProvider(contentProviders);var arrIdInStreamAds=parsedIdAdsGroups(contentProviders);var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),idContentProviders=_useState10[0],setIdContentProvider=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),idAdsGroups=_useState12[0],setIdAdsGroup=_useState12[1];var _useState13=useState({id:'',status:0}),_useState14=_slicedToArray(_useState13,2),idAndStatus=_useState14[0],setIdAndStatus=_useState14[1];useEffect(function(){if(idAndStatus===null||idAndStatus===void 0?void 0:idAndStatus.id)handleChangeIdAdsGroups(idAndStatus);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[idAndStatus===null||idAndStatus===void 0?void 0:idAndStatus.status]);var handleClose=function handleClose(){dispatch(closePopup());};var handleChangeContentProvider=function handleChangeContentProvider(item){var arrNew=_toConsumableArray(arrIdContentProvider);arrNew.push(item===null||item===void 0?void 0:item.id);if(arrNew[0]===undefined){arrNew.splice(0,1);setIdContentProvider(arrNew);}else setIdContentProvider(arrNew);};var handleChangeAds=function handleChangeAds(item){setIdAndStatus(_objectSpread(_objectSpread({},idAndStatus),{},{id:item===null||item===void 0?void 0:item.id,status:item===null||item===void 0?void 0:item.status}));handleChangeIdAdsGroups(idAndStatus);};var onChangeStatus=function onChangeStatus(item){if(idAndStatus===null||idAndStatus===void 0?void 0:idAndStatus.id){setIdAndStatus(_objectSpread(_objectSpread({},idAndStatus),{},{status:item===null||item===void 0?void 0:item.status}));}handleChangeIdAdsGroups(idAndStatus);};var handleChangeIdAdsGroups=function handleChangeIdAdsGroups(idAndStatus){var _idAds$;var idAds=_toConsumableArray(arrIdInStreamAds);idAds.push(idAndStatus);if(((_idAds$=idAds[0])===null||_idAds$===void 0?void 0:_idAds$.id)===undefined){idAds.splice(0,1);setIdAdsGroup(idAds);}else{setIdAdsGroup(idAds);}};var handleCreate=function handleCreate(){var idContent=currentItem===null||currentItem===void 0?void 0:currentItem.id;contentApi===null||contentApi===void 0?void 0:contentApi.editContent(idContent,idContentProviders,idAdsGroups).then(function(res){if(res===null||res===void 0?void 0:res.success){contentApi===null||contentApi===void 0?void 0:contentApi.getContentList(currentPage-1,rowPerPage,keyWord,category,type,idContentProvider,idAdsGroup).then(function(resList){var data=resList===null||resList===void 0?void 0:resList.data;if(resList===null||resList===void 0?void 0:resList.success){setCurrentPageList(data===null||data===void 0?void 0:data.items);dispatch(closePopup());}});}});};return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(CModal,{closeOnBackdrop:false,show:true,onClose:handleClose,centered:true,style:{minWidth:'555px'},children:[/*#__PURE__*/_jsx(CModalHeader,{style:{backgroundColor:'#646464'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-100 d-flex justify-content-between align-items-center\",style:{color:\"#FFF\"},children:[/*#__PURE__*/_jsx(\"h4\",{className:\"mb-0\",children:\"Add Content\"}),/*#__PURE__*/_jsx(CButton,{className:\"p-0 shadow-none\",onClick:handleClose,children:/*#__PURE__*/_jsx(CIcon,{name:\"cil-x\",style:{color:\"#FFF\"}})})]})}),/*#__PURE__*/_jsxs(CModalBody,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row\",children:[/*#__PURE__*/_jsx(GroupNameContentProvider,{dataContentList:dataContentList,handleChangeContentProvider:handleChangeContentProvider,getListAdsGroups:getListAdsGroups,handleScroll:handleScroll}),/*#__PURE__*/_jsx(GroupsAdsProvider,{listAdsGroup:listAdsGroups,handleChangeAds:handleChangeAds}),/*#__PURE__*/_jsx(StatusContentItem,{onChangeStatus:onChangeStatus,status:idAndStatus===null||idAndStatus===void 0?void 0:idAndStatus.status})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-end mt-3\",children:/*#__PURE__*/_jsx(CButton,{className:\"pl-4 pr-4\",color:\"success\",onClick:handleCreate,children:\"T\\u1EA1o\"})})]})]})});};export default PopupAddContentList;","map":{"version":3,"sources":["/Users/admin/Desktop/SourceDevVieON/LiveEvent/src/views/instream-ads/Popup/PopupAddContentList.js"],"names":["React","useEffect","useState","CButton","CModal","CModalBody","CModalHeader","CIcon","StatusContentItem","parsedIdAdsGroups","parsedIdContentProvider","parsedPageLimit","contentApi","GroupNameContentProvider","GroupsAdsProvider","useDispatch","closePopup","inStreamAdsApi","PopupAddContentList","props","currentItem","currentPage","rowPerPage","setCurrentPageList","keyWord","category","type","idContentProvider","idAdsGroup","currentPageProvider","setPageProvider","dataContentList","setDataProvider","metadataProvider","setMetadataProvider","listAdsGroups","setListAdsGroups","getListAdsGroups","id","getListAllInStreamAds","then","res","data","success","items","getList","getListContentProvider","metadata","dataList","newDataList","concat","watchScroll","window","addEventListener","handleScroll","removeEventListener","page","limit","total","maxPage","dispatch","contentProviders","arrIdContentProvider","arrIdInStreamAds","idContentProviders","setIdContentProvider","idAdsGroups","setIdAdsGroup","status","idAndStatus","setIdAndStatus","handleChangeIdAdsGroups","handleClose","handleChangeContentProvider","item","arrNew","push","undefined","splice","handleChangeAds","onChangeStatus","idAds","handleCreate","idContent","editContent","getContentList","resList","minWidth","backgroundColor","color"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react'\nimport {CButton, CModal, CModalBody, CModalHeader} from \"@coreui/react\";\nimport CIcon from \"@coreui/icons-react\";\nimport StatusContentItem from \"../ContentList/ItemContentList/StatusContentItem\";\nimport {parsedIdAdsGroups, parsedIdContentProvider, parsedPageLimit} from \"../../../helpers/common\";\nimport contentApi from \"../../../apis/contentApi\";\nimport GroupNameContentProvider from \"../ContentList/GroupNameContentProvider\";\nimport GroupsAdsProvider from \"../ContentList/GroupsAdsProvider\";\nimport {useDispatch} from \"react-redux\";\nimport {closePopup} from \"../../../actions/popup\";\nimport inStreamAdsApi from \"../../../apis/inStreamAdsApi\";\n\nconst PopupAddContentList = (props) => {\n\n  const {\n    currentItem,\n    currentPage,\n    rowPerPage,\n    setCurrentPageList,\n    keyWord,\n    category,\n    type,\n    idContentProvider,\n    idAdsGroup,\n\n  } = props || {}\n\n  const [currentPageProvider, setPageProvider] = useState(0)\n  const [dataContentList, setDataProvider] = useState([])\n  const [metadataProvider, setMetadataProvider] = useState()\n\n  const [listAdsGroups, setListAdsGroups] = useState([])\n\n  const getListAdsGroups = (id) => {\n    inStreamAdsApi.getListAllInStreamAds(id).then(res =>{\n      const data = res?.data\n      if (res?.success){\n        setListAdsGroups(data?.items)\n      }\n    })\n  }\n  useEffect( ()=>{\n    async function getList () {\n      contentApi.getListContentProvider(10, currentPageProvider).then(res=>{\n        const data = res?.data\n        if (res?.success) {\n          setMetadataProvider(data?.metadata)\n          let dataList = [...dataContentList]\n          let newDataList = dataList.concat(data?.items)\n          setDataProvider(newDataList)\n        }\n      })\n    }\n    getList()\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  },[currentPageProvider])\n\n\n  useEffect(() => {\n    function watchScroll() {\n      window.addEventListener(\"scroll\", handleScroll);\n    }\n    watchScroll()\n    return () => {\n      window.removeEventListener(\"scroll\", handleScroll);\n    }\n  })\n\n  const handleScroll = () => {\n    const { page, limit, total } = metadataProvider || {}\n    let maxPage = parsedPageLimit(total, limit)\n\n    if ((page + 1) * limit >= total && (page + 1) > maxPage) return\n    setPageProvider((page || 0) + 1 )\n  }\n  const dispatch = useDispatch()\n  const {contentProviders} = currentItem || {}\n  const arrIdContentProvider = parsedIdContentProvider(contentProviders)\n  const arrIdInStreamAds = parsedIdAdsGroups(contentProviders)\n\n  const [idContentProviders, setIdContentProvider] = useState([])\n  const [idAdsGroups, setIdAdsGroup] = useState([])\n  const [idAndStatus, setIdAndStatus] = useState({\n    id:'',\n    status: 0\n  })\n\n  useEffect(()=>{\n    if(idAndStatus?.id) handleChangeIdAdsGroups(idAndStatus)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  },[idAndStatus?.status])\n\n\n  const handleClose = () => {\n    dispatch(closePopup())\n  }\n  const handleChangeContentProvider = (item) => {\n    const arrNew = [...arrIdContentProvider]\n    arrNew.push(item?.id)\n    if (arrNew[0] === undefined){\n      arrNew.splice(0,1)\n      setIdContentProvider(arrNew)\n    }else setIdContentProvider(arrNew)\n  }\n  const handleChangeAds = (item) => {\n    setIdAndStatus({...idAndStatus, id: item?.id, status: item?.status})\n    handleChangeIdAdsGroups(idAndStatus)\n  }\n  const onChangeStatus = (item) => {\n    if(idAndStatus?.id) {\n      setIdAndStatus({...idAndStatus, status: item?.status})\n    }\n    handleChangeIdAdsGroups(idAndStatus)\n  }\n\n  const handleChangeIdAdsGroups = (idAndStatus) => {\n    let idAds = [...arrIdInStreamAds]\n    idAds.push(idAndStatus)\n    if (idAds[0]?.id === undefined){\n      idAds.splice(0,1)\n      setIdAdsGroup(idAds)\n    }else {\n      setIdAdsGroup(idAds)\n    }\n  }\n  const handleCreate = () => {\n    const idContent = currentItem?.id\n    contentApi?.editContent(idContent, idContentProviders, idAdsGroups).then(res=>{\n        if (res?.success){\n          contentApi?.getContentList(\n            currentPage-1,\n            rowPerPage,\n            keyWord,\n            category,\n            type,\n            idContentProvider,\n            idAdsGroup\n          ).then(resList =>{\n              const data = resList?.data\n              if (resList?.success) {\n                setCurrentPageList(data?.items)\n                dispatch(closePopup())\n              }\n            }\n          )\n      }\n    })\n  }\n\n\n  return(\n\n    <React.Fragment>\n      <CModal\n        closeOnBackdrop={false}\n        show={true}\n        onClose={handleClose}\n        centered={true}\n        style={{minWidth:'555px'}}\n      >\n        <CModalHeader style={{ backgroundColor: '#646464' }}>\n          <div className=\"w-100 d-flex justify-content-between align-items-center\" style={{ color: \"#FFF\" }}>\n            <h4 className=\"mb-0\">Add Content</h4>\n            <CButton className='p-0 shadow-none' onClick={handleClose}>\n              <CIcon name=\"cil-x\" style={{ color: \"#FFF\" }}></CIcon>\n            </CButton>\n          </div>\n        </CModalHeader>\n        <CModalBody>\n          <div className=\"d-flex flex-row\">\n            <GroupNameContentProvider\n              dataContentList={dataContentList}\n              handleChangeContentProvider={handleChangeContentProvider}\n              getListAdsGroups={getListAdsGroups}\n              handleScroll={handleScroll}\n            />\n            <GroupsAdsProvider\n              listAdsGroup={listAdsGroups}\n              handleChangeAds={handleChangeAds}\n            />\n            <StatusContentItem\n              onChangeStatus={onChangeStatus}\n              status ={idAndStatus?.status}\n            />\n          </div>\n          <div className=\"d-flex justify-content-end mt-3\">\n            <CButton className=\"pl-4 pr-4\" color=\"success\" onClick={handleCreate}>Táº¡o</CButton>\n          </div>\n        </CModalBody>\n      </CModal>\n    </React.Fragment>\n  )\n}\nexport default PopupAddContentList\n"]},"metadata":{},"sourceType":"module"}